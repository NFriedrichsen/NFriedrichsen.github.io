---
title: "Probabilities Lab"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Probability Rules

**Disjoint Events** are events that can't happen at the same time.

Disjoint events A and B satisfy P(A and B) = 0

**Complement Rule**: P(not A) = 1 - P(A)

**Additive Rule**: P(A or B) = P(A) + P(B) - P(A and B)

Special: A and B disjoint $\rightarrow$ P(A or B) = P(A) + P(B)

**Multiplicative Rule**: P(A and B) = P(A if B)$\times$P(B) = P(B if A)$\times$P(A)

Special: A and B are independent $\rightarrow$ P(A and B) = P(A)$\times$P(B)

**Conditional Probabilities**: P(A if B) = $\frac{\text{P(A and B)}}{\text{P(B)}}$

**Independent Events**: A and B are independent if P(A if B) = P(A)

---

# Probabilities using Tables

For this question we will be return to using the Titanic dataset built into R, providing information on the fate of the passengers on the fatal maiden voyage of the ocean liner Titanic summarized according to economic status (class), sex, age, and survival. As you will hopefully see in the next set of questions, having access to a table of data can make answering probability questions a lot easier.

```{r, message=F}
library(ggplot2)
library(dplyr)

theme_set(theme_bw())

## Data for lab
data(Titanic)
titanic <- as.data.frame(Titanic)
titanic <- titanic[rep(1:nrow(titanic), times = titanic$Freq), ]
titanic$Freq <- NULL
```

A review of functions we've seen before:

- The `table()` function which returns a count of categorical data
- The `proportions()` function which takes a table as an argument and returns a (optionally conditional) table of proportions
- The `addmargins()` function will sum the margins of a table

Use the following table of Titanic data to answer the questions below. You can change the table to proportions using the `proportions()` function if it helps you (but be careful with overall/row/column proportions). Practice using the probability short notation as your write your answers. For example: P(Survived) in **Part A**.

```{r}
with(titanic, table(Survived, Class)) %>% addmargins()
```
### Question 1

**Part A:** For a randomly selected passenger, what is the probability they survived?

```{r, echo=F, include=F}
711 / 2201
```

**Part B:** For a randomly selected passenger, what is the probability they were in 1st class?

```{r, echo=F, include=F}
325 / 2201
```

**Part C:** For a randomly selected passenger, what is the probability they were in 1st class *and* survived?

```{r, echo=F, include=F}
203 / 2201
```

**Part D:** Given that a passenger was in 1st class, what is the probability they survived?

```{r, echo=F, include=F}
203 / 325
```

**Part E:** Given that a passenger survived, what is the probability they were in 1st class?

```{r, echo=F, include=F}
203 / 711
```

**Part F:** Are the events "Survived" and "1st class" disjoint? Explain.

```{r, echo=F, include=F}
# No. There are 203 instances of both events occurring at the same time.
```

**Part G:** Are the events "Survived" and "1st class" independent? Justify your answer by comparing appropriate probabilities from Parts A through E. (There are many such comparisons)

```{r, echo=F, include=F}
# No. One example:
# P(survived | first class) =/= P(survived)
```

---

# Probabilities using Formulas

We can accomplish a lot with only a few probabilities given to us if we use the probability formulas, it's just more difficult and time consuming than using a table. For this problem we are going to start with data on heart attacks and medications similar to a study from the slides, but with different values.

**Question 2**: Use the following information to answer the question parts below:

- The probability that a subject did not have a heart attack is 0.98
- The probability that a subject took aspirin is 0.64
- The probability that a subject got the placebo is 0.36
- The probability that a subject took aspirin *and* had a heart attack is 0.01
- The probability that a subject had a heart attack *given* they were using the placebo is 0.028

**Part A**: What is P(heart attack)?

```{r, echo=F, include=F}
1 - 0.98
```

**Part B**: What is P(heart attack if taking aspirin)?

```{r, echo=F, include=F}
.01 / .64
```

**Part C**: What is P(heart attack and taking placebo)?

```{r, echo=F, include=F}
.028 * .36
```

**Part D**: What is P(heart attack or aspirin)?

```{r, echo=F, include=F}
0.02 + .54 - .01
```

**Part E**: According to the data, is it more likely someone has a heart attack while taking aspirin or taking no medication (placebo)? 

```{r, echo=F, include=F}
# P(HA | placebo) > P(HA | aspirin)
```

**Part F**: Are the events "Heart Attack" and "Taking aspirin" independent according to our data?

```{r, echo=F, include=F}
# No. P(HA | aspirin) =/= P(HA) 
```

**Part G**: Suppose your friend uses the probabilities P(heart attack and aspirin) = .01 and P(heart attack and placebo) = .01 and concludes that the aspirin doesn't have any effect on the probability of having a heart attack? Point out the flaw in their reasoning.